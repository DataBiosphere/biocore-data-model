name: AnVILSubmissionDataFindabilitySubsetSchema
description: AnVIL Submission Data Findability, following the BioCore data model and distributed as LinkML/yaml, JSON-schema, TDR JSON, and excel templates.
id: https://github.com/DataBiosphere/biocore-data-model/tree/main/content
prefixes:
  linkml: https://w3id.org/linkml/
  AnVIL: https://AnVILproject.org/
  hpo: https://hpo.jax.org/app/browse/term/
  PATO: https://www.ebi.ac.uk/ols4/ontologies/pato/
  CL: http://purl.obolibrary.org/obo/CL_
  MONDO: http://purl.obolibrary.org/obo/MONDO_
  UBERON: http://purl.obolibrary.org/obo/UBERON_

imports:
   - linkml:types # this imports the linkml types schema
default_range: string # if not specified, the default range is string

classes: # these are the tables in the data model
  # Any:
  #   class_uri: linkml:Any
  BioSample:
    description: Contains information about the sample(s) included in the study.
    slots:
      - biosample_id
      - anatomical_site
      - anatomical_site_code
      - anatomical_site_coding_system
      - apriori_cell_type
      - apriori_cell_type_code
      - apriori_cell_type_coding_system
      - biosample_type
      - biosample_type_code
      - biosample_type_coding_system
      - primary_condition
      - primary_condition_code
      - primary_condition_coding_system
      - donor_age_at_collection_unit
      - donor_age_at_collection_lower_bound
      - donor_age_at_collection_upper_bound
      - donor_id_fk # this is the foregin key to the donor table
  Donor:
    description: Demographic and phenotypic information about the donor.
    slots:
      - donor_id
      - donor_type
      - organism_type
      - organism_type_code
      - organism_type_coding_system
      - phenotypic_sex
      - phenotypic_sex_code
      - phenotypic_sex_coding_system
      - reported_ethnicity
      - reported_ethnicity_code
      - reported_ethnicity_coding_system
      - genetic_ancestry
      - genetic_acestry_code
      - genetic_ancestry_coding_system
  File:
    description: Information for files associated with the study.
    slots:
      - file_id
      - data_modality
      - file_format
      - file_size
      - file_md5sum # say that it is_a: checksum
      - file_name
      - file_ref
      - reference_assembly
      - biosample_id_fk # this is the foregin key to the biosample table
  Condition:
    description: Contains information about the condition(s) of the donor.
    slots:
      - condition_id
      - condition
      - condition_code
      - condition_coding_system
      - donor_is_affected
      - donor_id_fk
      - observation_age_unit
      - observation_age_lower_bound
      - observation_age_upper_bound
      - onset_age_unit
      - onset_age_lower_bound
      - onset_age_upper_bound
  Activity:
    description: Contains information about the activity that was performed.
    slots:
      - activity_id
      - activity_type
      - activity_type_code
      - activity_type_coding_system
      - used_file_id
      - generated_file_id
      - used_biosample_id
      - generated_biosample_id
      - data_modality
  Project:
    description: Contains information about the project.
    slots:
      - project_id
      - title
      - funded_by
      - registered_identifier
      - principal_investigator


slots: ## ids are unique identifiers for each entity or explicitly defined foreign key
# foreign keys
  donor_id_fk:
    aliases: hasDonor
    description: This property references the Donor organism from which the BioSample was acquired.
    range: Donor
    # domain: BioSample
    multivalued: true # changed by data dictionary
    inlined: true
  biosample_id_fk:
    aliases: hasBioSample
    description: The BioSample ID representing the biosample that was used to generate the file.
    range: BioSample #determine if we want to set up a foreign key to the biosample table
    # domain: File
    multivalued: false
  used_file_id:
    description: Associated file ID that links to the record in the file table representing the file used in this activity.
    range: File
    domain: Activity
    multivalued: true
  generated_file_id:
    description: Associated file ID that links to the record in the file table representing the file generated by this activity.
    range: File
    domain: Activity
    multivalued: true
  used_biosample_id:
    description: A reference to the sample used by this activity.
    range: BioSample
    domain: Activity
    multivalued: true
  generated_biosample_id:
    description: A reference to the sample generated by this activity.
    range: BioSample
    domain: Activity
    multivalued: true

  # primary keys
  biosample_id:
    identifier: true  # this is the type of primary key
    description: A unique identifier for the biosample.
    range: string
    # inlined: true
  donor_id:
    identifier: true  # this is the type of primary key
    description: A unique identifier for the donor.
    range: string
    # inlined: true
  file_id:
    identifier: true  # this is the type of primary key
    description: A unique identifier for the file.
    range: string
    # inlined: true
  condition_id:
    identifier: true  # this is the type of primary key
    description: A unique identifier for the documented condition - internal identifier.
    range: string
    # inlined: true
  activity_id:
    identifier: true  # this is the type of primary key
    description: A unique identifier for the activity.
    range: string
    # inlined: true
  project_id:
    identifier: true  # this is the type of primary key
    description: A unique identifier for the project.
    range: string
    # inlined: true

  # data columns
  activity_type:
    description: A human-readable reference to the type of activity, preferably using an identifier in a recommended standard ontology.
    multivalued: false
  activity_type_code:
    description: Code associated with the activity type concept in a coding system; system and label are specified in a separate field.
    multivalued: false
  activity_type_coding_system:
    description: Reference (URL, etc) to the system that the code and title came from.
    multivalued: false
  anatomical_site:
    aliases: hasAnatomicalSite
    description: A human-readable reference to the site within the organism from which the biosample was taken.
    multivalued: false
  anatomical_site_code: 
    description: Code associated with the anatomical site concept in a coding system; system and label are specified in a separate field.
    multivalued: false
  anatomical_site_coding_system:
    description: Reference (URL, etc) to the system that the code and title came from.
    multivalued: false
  apriori_cell_type:
    aliases: hasAprioriCellType
    description: A human-readable reference to the a priori cell type(s) for the sample, a human assignment of cell type without experimental data.
    multivalued: true
  apriori_cell_type_code:
    description: Code associated with the a priori cell type concept in a coding system; system and label are specified in a separate field.
    multivalued: true
    range: APrioriCellTypeValues
  apriori_cell_type_coding_system:
    description: Reference (URL, etc) to the system that the code and title came from.
    multivalued: true
  biosample_type:
    description: A human-readable reference to the type of biosample represented by the record.
    multivalued: false
    range: BioSampleTypeValues
  biosample_type_code:
    description: Code associated with the biosample type concept in a coding system; system and label are specified in a separate field.
    multivalued: false
  biosample_type_coding_system:
    description: Reference (URL, etc) to the system that the code and title came from.
    multivalued: false
  condition:
    description: A human-readable property that describes a disease, condition, or phenotype that has been reported in this entity in a human readable manner (as opposed to a code/id/etc). If multiple values exist, they must be synonymous.
    multivalued: false
  condition_code:
    description: Code associated with the condition concept in a coding system; system and label are specified in a separate field. If multiple values exist, they must be synonymous.
    multivalued: false
    range: uriorcurie
    any_of:
      - range: MonarchDiseaseOntology
      - range: HumanPhenotypeOntology
      - range: SNOMEDCT
  condition_coding_system:
    description: Reference (URL, etc) to the system that the code and title came from.
    multivalued: false
  donor_age_at_collection_unit:
    description: The units (e.g. years or days) of the Age of the Donor at the point in time that the BioSample was obtained or other representative entity (test, diagnosis, treatment...) was created.
    multivalued: false
  donor_age_at_collection_lower_bound:
    description: Lower bound for age of donor at time sample was taken. If any age at collection data is present, must specify a unit as well.
    range: float
    multivalued: false
  donor_age_at_collection_upper_bound:
    description: Upper bound for age of donor at time sample was taken. If any age at collection data is present, must specify a unit as well.
    range: float
    multivalued: false
  donor_is_affected:
    description: A Boolean value representing whether a subject is affected by a documented condition or not. Allows documentation of pertinent negatives. If empty, defaults to true.
    multivalued: false
  donor_type:
    description: Type of donor represented by the record. If blank, the data will be treated as Patient by default.
    multivalued: false
    range: DonorTypeValues
  funded_by:
    description: A relationship defining the funding source.  The range is expected to include grants, organizations, or a string indicating the funding source.
    multivalued: true
  observation_age_unit:
    description: A reference to the unit of time used to represent age.
    multivalued: false
  observation_age_lower_bound:
    description: Earliest age a patient was diagnosed or identified as having a condition/phenotype. If providing an exact age, lower and upper bounds should be the same value.
    range: float
    multivalued: false
  observation_age_upper_bound:
    description: Latest age a patient was diagnosed or identified as having a condition/phenotype. If providing an exact age, lower and upper bounds should be the same value.
    range: float
    multivalued: false
  onset_age_unit:
    description: A reference to the unit of time used to represent age.
    multivalued: false
  onset_age_lower_bound:
    description: Earliest age for condition onset. If providing an exact age, lower and upper bounds should be the same value.
    range: float
    multivalued: false
  onset_age_upper_bound:
    description: Latest age for condition onset. If providing an exact age, lower and upper bounds should be the same value.
    range: float
    multivalued: false
  organism_type:
    aliases: hasOrganismType
    description: A human-readable reference to the organism type.
    comments:
    - 'For example: Homo sapiens from NCBITaxon or http://purl.obolibrary.org/obo/NCBITaxon_9606 '
    multivalued: false
  organism_type_code:
    description: Code associated with the organism type concept in a coding system; system and label are specified in a separate field.
    multivalued: false
  organism_type_coding_system:
    description: Reference (URL, etc) to the system that the code and title came from.
    multivalued: false
  phenotypic_sex:
    aliases: hasPhenotypicSex
    description: A reference to the BiologicalSex of the Donor organism. \"An organismal quality inhering in a bearer by virtue of the bearer's physical expression of sexual characteristics. [PATO_0001894]\
    multivalued: false
    range: PhenotypicSexValues
  phenotypic_sex_code:
    description: Code associated with the biological sex concept in a coding system; system and label are specified in a separate field.
    multivalued: false
  phenotypic_sex_coding_system:
    description: Reference (URL, etc) to the system that the code and title came from.
    multivalued: false
  principal_investigator:
    description: A relationship defining the principal investigator.  The range is expected to include a person or a string indicating the principal investigator.
    multivalued: true
  primary_condition:
    aliases: hasDisease
    description: A human-readable property that identifies a disease or condition has been reported in this entity.
    multivalued: false
  primary_condition_code:
    description: Code associated with the disease concept in a coding system; system and label are specified in a separate field.
    multivalued: false
  primary_condition_coding_system:
    description: Reference (URL, etc) to the system that the code and title came from.
    multivalued: false
  registered_identifier:
    description: Registered identifier for the project, such as the dbGaP PHS ID.
    multivalued: true
  reported_ethnicity:
    aliases: hasReportedEthnicity
    description: A property that relects a Human Donor's reported ethnic origins. Note this may contain both Race and Ethnicity information as define by the US Department of Interior (DOI) https://www.doi.gov/pmb/eeo/directives/race-data
    multivalued: true
  reported_ethnicity_code:
    description: Code associated with the reported ethnicity concept in a coding system; system and label are specified in a separate field.
    multivalued: true
  reported_ethnicity_coding_system:
    description: Reference (URL, etc) to the system that the code and title came from.
    multivalued: true
  title:
    description: Easily understood title for project.
    multivalued: false
  genetic_ancestry:
    aliases: hasGeneticAncestry
    description: A human-readable property that reflects a donor's reported major contributing ancestral origins based on genetic/genomic data.
    multivalued: true
  genetic_acestry_code:
    description: Code associated with the genetic ancestry concept in a coding system; system and label are specified in a separate field.
    multivalued: true 
  genetic_ancestry_coding_system:
    description: Reference (URL, etc) to the system that the code and title came from.
    multivalued: true
  data_modality:
    aliases: hasDataModality
    description: Data modality describes the biological nature of the information gathered as the result of an Activity, independent of the technology or methods used to produce the information.
    multivalued: true
  file_name:
    description: The name of the file.
    multivalued: false
  file_ref:
    description: The fully qualified path to the file.
    multivalued: false
  file_format:
    aliases: hasFileFormat
    description: An indication of the format of an electronic file; include the full file extension including compression extensions. Usually aligns with file extension (e.g. bam, sam, text, csv, etc.)
    multivalued: false
  file_size:
    aliases: hasFileSize
    description: Size of file in megabytes.
    multivalued: false
    range: integer
  file_md5sum:
    description: md5 checksum for the file
    multivalued: false
  reference_assembly:
    aliases: usesReferenceAssembly
    description: A reference to the collection of sequences taken as the standard for a given organism. May be defined by https://www.ncbi.nlm.nih.gov/grc.
    multivalued: true
  age_at_death:
    aliases: hasAgeAtDeath
    description: A reference to the Age of the Donor at time of death. The units are assumed to be years.
    slot_uri: https://datamodel.terra.bio/TerraCore#hasAgeAtDeath
    multivalued: false
    range: decimal

enums:
  ActivityTypes:
    permissible_values:
      SampleCollectionActivity:
      SampleTreatmentActivity:
      SequenceActivity:
      AlignmentActivity:
      VariantCallActivity:
      ExpressionActivity:
      AnalysisActivity:
      ImageActivity:
      IndexActivity:
      ChecksumActivity:
      Activity:
  PhenotypicSexValues:
    permissible_values:
      female:
        meaning: PATO:0000383
      male:
        meaning: PATO:0000384
      intersex:
        description: between male and female sex
      prefer not to say:
        description: the individual prefers not to disclose
  DonorTypeValues:
    permissible_values:
      patient:
      cell line:
  DataModalityValues:
    permissible_values:
      epigenomic:
      3D contact maps:
      DNA binding:
      histone modification location:
      transcription factor location:
      DNA chromatin accessibility:
      DNA methylation:
      RNA binding:
      genomic:
      assembly:
      exome:
      genotyping:
      whole genome:
      imaging:
      electrophysiology:
      medical imaging:
      CT scan:
      electrocardiogram:
      MRI:
      X ray:
      microscopy:
      metabolomic:
      microbiome:
      proteomic:
      transcriptomic:
      spatial transcriptomics:
      transcriptomic nontargeted:
      transcriptomic targeted:
  BioSampleTypeValues:
    permissible_values:
      cell line:
      primary culture:
      T cell:
      platelet:
      B cell:
      lymphocyte:
      monocyte:
      amniotic fluid:
      blood:
      urine:
      synovial fluid:
      cerebrospinal fluid:
      saliva:
      semen:
      plasma:
      serum:
      stool:
      vaginal fluid:
      body fluid:
      breast milk:
      buffy coat:
      cell free DNA:
      derived type:
      erythrocyte:
      induced pluripotent stem cells:
      in vitro differentiated cells:
      leukocyte:
      organoid:
      peripheral blood mononuclear cell:
      primary cell:
      primary type:
      tissue:
# dynamic enums
  APrioriCellTypeValues:
    reachable_from:
      source_ontology: obo:cl
      source_nodes:
        - CL:0000000
      include_self: false
      relationship_types:
        - rdfs:subClassOf
  MonarchDiseaseOntology:
    reachable_from:
      source_ontology: bioregistry:mondo
      source_nodes:
        - MONDO:0000001 ## disease or disorder
      is_direct: false
      relationship_types:
        - rdfs:subClassOf
    minus:
      - permissible_values:
          root_node:
            meaning: MONDO:0000001 ## disease or disorder
  HumanPhenotypeOntology:
    reachable_from:
      source_ontology: hpo
      source_nodes:
        - HP:0000001
      include_self: false
      relationship_types:
        - rdfs:subClassOf
  SNOMEDCT:
    reachable_from:
      source_ontology: bioregistry:snomedct
      source_nodes:
        - SNOMEDCT:404684003
      is_direct: false
      relationship_types:
        - rdfs:subClassOf

# HumanPhenotypeOntology:
  #   permissible_values:
  #     reachable_from:
  #       source_ontology: hpo
  #       source_nodes:
  #         - HP:0000001
  #       include_self: false
  #       relationship_types:
  #         - rdfs:subClassOf

  # LoincExample:
  #   enum_uri: http://hl7.org/fhir/ValueSet/example-intensional
  #   see_also:
  #     - https://build.fhir.org/valueset-example-intensional.json.html
  #   include:
  #     - reachable_from:
  #         source_ontology: bioregistry:loinc
  #         source_nodes:
  #           - LOINC:LP43571-6
  #         is_direct: true
  #   minus:
  #     concepts:
  #       - LOINC:5932-9  # for example, remove terms with 3rd party licensing restrictions
